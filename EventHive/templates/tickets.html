<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Tickets - EventHive</title>
    <link rel="stylesheet" href="/static/css/styles.css">
    <script src="/static/js/main.js" defer></script>
</head>
<body>
    <header>
        <h1>EventHive</h1>
        <nav>
            <a href="/dashboard.html">Dashboard</a>
            <a href="/booking.html">Book Tickets</a>
            <a href="#" onclick="logoutUser()">Logout</a>
        </nav>
    </header>

    <main>
        <h2>My Tickets</h2>
        <p id="userInfo"></p>
        
        <div id="ticketsContainer" class="bookings-grid">
            <!-- Tickets loaded dynamically -->
        </div>
    </main>

    <script>
        async function loadTickets() {
            const user_id = localStorage.getItem("user_id");
            const res = await fetch(`/bookings/user/${user_id}`);
            const bookings = await res.json();
            const container = document.getElementById("ticketsContainer");
            container.innerHTML = "";

            bookings.forEach(b => {
                if (b.status === "confirmed") {
                    const div = document.createElement("div");
                    div.className = "booking-card";
                    div.innerHTML = `
                        <p><strong>Event ID:</strong> ${b.event_id}</p>
                        <p><strong>Tickets:</strong> ${b.quantity} (${b.ticket_type})</p>
                        <a href="/bookings/${b.booking_id}/ticket" target="_blank">Download PDF Ticket</a>
                    `;
                    container.appendChild(div);
                }
            });
        }

        document.addEventListener("DOMContentLoaded", function() {
            loadTickets();
        });
    </script>
</body>
</html>